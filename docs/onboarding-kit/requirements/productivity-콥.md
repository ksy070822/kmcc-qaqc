# 생산성 (Productivity) - 요구사항 정의서

> 담당: 콥
> 작성일: 2026-02-26
> 상태: [x] 초안 / [ ] 검토중 / [ ] 확정

---

## 0. 현재 시스템 기본 정보 (참고용 - 메이 작성)

> 아래는 이미 구축된 대시보드의 기본 정보입니다.
> 생산성 지표를 추가할 때 이 체계와 맞춰야 합니다.

### 센터 구분
- **용산**: 택시, 대리, 퀵/배송
- **광주**: 택시, 대리, 퀵/배송, 바이크, 주차

### 채널 구분
- 유선, 채팅, 게시판, 외국어

### 상담사 근속 구분
- 신입 (2개월 미만) / 초기 (2~6개월) / 일반 (6~12개월) / 경력 (12개월+)

### 현재 통합 품질 가중치 (생산성 미포함 상태)
| 도메인 | 비중 | 담당 |
|--------|:----:|------|
| QA (상담평점) | 30% | 리샬 |
| QC (품질관리) | 30% | 메이 |
| CSAT (고객만족) | 25% | - |
| 직무테스트 | 15% | 메이 |
| **생산성** | **미반영** | **콥** |

> 생산성은 SLA 점수(100점 만점) 내에서 품질 40점 + 생산성 60점으로 이미 반영됨.
> 통합 품질(리스크) 가중치에는 미포함. 아래 7번 항목에서 연계 방향 정의.

### 주간 보고 주기
- 주간 기준: 목요일~수요일
- 주차별 구성: 월초(1주차) → 2주차 → 3주차 → 월말(4주차)

---

## 1. 지표 목록

대시보드에 보여줄 **생산성 지표**를 모두 적어주세요.
계산식은 최대한 구체적으로 (AI가 바로 코드로 만들 수 있을 정도로).

| # | 지표명 | 계산식 | 단위 | 높을수록 좋은지 | 비고 |
|---|--------|--------|------|:--------------:|------|
| 1 | 유선 응대율 | 응답건수(grp_1160) ÷ 인입건수(grp_1090) × 100 | % | 좋음 | 센터별·버티컬별 |
| 2 | 유선 인입건수 | grp_1090 합계 (IB offered) | 건 | - | |
| 3 | 유선 응답건수 | grp_1160 합계 (IB answered) | 건 | 좋음 | |
| 4 | 유선 OB건수 | grp_1140 합계 (Outbound) | 건 | - | |
| 5 | 유선 ATT (평균 통화시간) | 총통화시간(qsa_1210) ÷ 처리건수(qsa_1030) | 초 | 나쁨 | 낮을수록 좋음 |
| 6 | 유선 ACW (평균 후처리시간) | 총후처리시간(agtm_1200) ÷ 후처리건수(agtm_1130) | 초 | 나쁨 | 낮을수록 좋음 |
| 7 | 유선 AHT (평균 처리시간) | ATT + ACW | 초 | 나쁨 | 낮을수록 좋음 |
| 8 | 유선 평균 대기시간(ASA) | 총대기시간(grp_1570) ÷ 응답건수(grp_1160) | 초 | 나쁨 | 낮을수록 좋음 |
| 9 | 채팅 응대율 | 응답건수 ÷ 인입건수 × 100 | % | 좋음 | CEMS consult 기준 |
| 10 | 채팅 인입건수 | first_queue_at 존재 건수 | 건 | - | |
| 11 | 채팅 응답건수 | first_assign_at + chat_end_status 존재 건수 | 건 | 좋음 | |
| 12 | 채팅 평균 대기시간 | chat_start_at - first_queue_at (초) | 초 | 나쁨 | 목표 120초 이하 |
| 13 | 채팅 평균 처리시간 | chat_sec + wrapup_sec | 초 | 나쁨 | 서비스별 목표 상이 |
| 14 | 게시판 인입건수 | channel_code IN (c1_chatbot, c1_webboard, c1_appboard) | 건 | - | |
| 15 | 게시판 처리건수 | first_consult_start_at 존재 건수 | 건 | 좋음 | |
| 16 | 외국어 응대율 | 응답건수 ÷ 인입건수 × 100 | % | 좋음 | group_name LIKE '%외국어%' |

---

## 2. 목표값 / 기준값

각 지표의 목표를 센터별로 적어주세요. (현재 QC 목표 참고: 용산 태도 3.3%, 광주 2.7%)

| 지표 | 용산 목표 | 광주 목표 | 전체 목표 | 서비스별 차이 있는지 |
|------|-----------|-----------|-----------|:------------------:|
| 유선 응대율 | 85% | 85% | 85% | [ ] 있음 / [x] 없음 |
| 채팅 응대율 | 90% | 90% | 90% | [ ] 있음 / [x] 없음 |
| 채팅 대기시간 | 120초 이하 | 120초 이하 | 120초 이하 | [ ] 있음 / [x] 없음 |
| 유선 AHT | 서비스별 | 서비스별 | - | [x] 있음 / [ ] 없음 |
| 채팅 처리시간 | 서비스별 | 서비스별 | - | [x] 있음 / [ ] 없음 |

### 서비스별 목표가 다른 경우 (해당 시)

| 서비스 | 유선 AHT 목표(초) | 채팅 처리시간 목표(초) | 비고 |
|--------|-------------------|------------------------|------|
| 택시 | 185 | 500 | |
| 대리 | 185 | 492 | |
| 퀵/배송 | 200 | 1770 | 퀵, 배송 동일 |
| 바이크 | - | - | 광주만 |
| 주차 | - | - | 광주만 |

---

## 3. 데이터 출처 & 컬럼 정의

### 원본 데이터 형태

- [ ] 엑셀 파일 → 파일명: _______________
- [ ] Google Sheets → URL: _______________
- [ ] CTI/ACD 시스템 추출 → 시스템명: _______________
- [x] 기타: **dataanalytics-25f2 DW (IPCC, CEMS)**

### 데이터 소스 테이블

| 채널 | 프로젝트·데이터셋 | 테이블 | 용도 |
|------|-------------------|--------|------|
| 유선 | dataanalytics-25f2.dw_ipcc_iprondb | tb_stat_ic_grp_call_dd | 응대율, 인입/응답/OB, 대기시간 |
| 유선 | dataanalytics-25f2.dw_ipcc_iprondb | tb_stat_ic_que_skill_agt_dd | ATT (통화시간) |
| 유선 | dataanalytics-25f2.dw_ipcc_iprondb | tb_stat_ic_agt_state_dd | ACW (후처리시간) |
| 채팅 | dataanalytics-25f2.dw_cems | consult, chat_inquire, consult_status, user | 응대율, 대기/처리시간 |
| 게시판 | dataanalytics-25f2.dw_cems | consult, user | 인입/처리 건수 |
| 외국어 | dataanalytics-25f2.dw_ipcc_iprondb | tb_stat_ic_grp_call_dd (group_name LIKE '%외국어%') | 응대율 |

### 주요 컬럼 매핑 (유선 IPCC grp_call)

| 컬럼명 | 의미 | 데이터 타입 | 예시 값 | 필수 여부 |
|--------|------|------------|---------|:---------:|
| psr_time_key | 통계일자 (YYYYMMDD) | STRING | 20260201 | 필수 |
| group_name | 그룹명 (센터·서비스 매핑용) | STRING | 용산센터택시 | 필수 |
| grp_1090 | IB 인입건수 (offered) | 숫자 | 150 | 필수 |
| grp_1160 | IB 응답건수 (answered) | 숫자 | 142 | 필수 |
| grp_1140 | OB 건수 | 숫자 | 5 | |
| grp_1570 | 총 대기시간(초) | 숫자 | 12000 | |

### 데이터 주기 & 업로드

- 데이터 갱신 주기: [x] 일별 / [ ] 주별 (___요일) / [ ] 월별
- 업로드 방식: [x] 자동 (시스템 연동) / [ ] 수동 (엑셀 업로드)
- 보관 기간: [x] 최근 ___개월 (DW 보관 정책 따름)

---

## 4. 조회 조건 (필터)

대시보드에서 필터링할 수 있어야 하는 항목을 체크하세요.

- [x] 기간 (시작일 ~ 종료일) ← 기본 필수
- [x] 센터 (용산 / 광주 / 전체) ← 기본 필수
- [ ] 서비스 (택시, 대리, 배송 등) ← 탭별로 버티컬 구분 이미 있음
- [x] 채널 (유선 / 채팅 / 게시판 / 외국어 / 전체) ← 탭으로 구현됨
- [ ] 그룹 (조별)
- [ ] 상담사 개인 검색
- [ ] 근속 구분 (신입/초기/일반/경력)
- [ ] 기타: _______________

---

## 5. 화면 구성

### 5-1. KPI 카드 (상단 한눈에 보기)

보여줄 카드를 체크하고, 가능하면 부가 정보도 적어주세요.

- [x] 총 처리건수 (전월 대비 증감 표시? Y) — 응답건수 기준
- [x] 응대율 (목표 대비 표시? Y) — 유선 85%, 채팅 90%
- [x] AHT/처리시간 (목표 대비 표시? Y) — 서비스별 목표
- [x] 목표 달성률 — isTargetMet 기준 색상 표시
- [x] 기타: CPD(일평균 처리건수), 센터별·버티컬별 요약

### 5-2. 차트

- [x] 일별 추이 라인 차트 → 응대율, 인입/응답 건수
- [x] 주별 추이 라인 차트 → 주간 요약 (목~수 기준)
- [x] 센터별 비교 바 차트 — overview/verticalStats
- [x] 서비스별 비교 차트 — verticalStats
- [ ] 상담사 순위 (상위/하위 N명) → N = ___ (추후)
- [ ] 기타: _______________

### 5-3. 테이블

- [x] 서비스(버티컬)별 요약 → 컬럼: 센터, 서비스, 응대율, 인입, 응답, CPD, 처리시간
- [x] 일별 상세 (추이) → 컬럼: 날짜, 센터, 인입, 응답, 응대율
- [ ] 상담사별 상세 → 컬럼: _______________ (추후)
- [ ] 기타: _______________

---

## 6. 업무 규칙 & 예외 처리

> AI가 코드를 짤 때 반드시 알아야 하는 규칙들입니다.
> 최대한 구체적으로 적어주세요.

1. **유선(IPCC) 제외 그룹**: group_name에 다음이 포함된 그룹은 집계에서 제외
   - `%Outbound%`, `%RM(O/B)%`, `%센터교육%`, `%퇴직자%`, `%파트너%`
2. **유선·채팅 센터 필터**: `group_name LIKE '%용산센터%' OR group_name LIKE '%광주센터%'` 만 포함
3. **채팅 제외**: `incoming_path LIKE 'c2_voice_%'` 또는 `incoming_path = 'c2_cti_center_code_error'` 제외
4. **채팅 처리시간 이상치**: wait_sec, chat_sec, wrapup_sec 각각 0~7200초(2시간), 0~36000초(10시간) 범위만 평균 산출
5. **센터-버티컬 유효 조합**: 용산은 택시/대리/퀵배송만, 광주는 택시/대리/퀵배송/바이크/주차 (CENTER_VERTICALS)

---

## 7. 통합 품질과의 연계

> 현재 통합 리스크 점수는 QA(30%) + QC(30%) + CSAT(25%) + 직무테스트(15%) = 100%
> 생산성은 SLA 100점 내에서 품질 40점 + 생산성 60점으로 이미 반영됨.

### 생산성을 통합 품질 점수에 포함할 건가요?

- [ ] 포함 → 희망 비중: ___%
- [x] 포함하지 않음 (별도 지표로만 운영, SLA 내 생산성 60점은 유지)
- [ ] 미정 (추후 논의)

### SLA 내 생산성 60점 환산 방법 (현재 구현)

- 응대율·처리시간·대기시간 등 지표를 목표 대비 달성률로 환산 후 가중 평균
- 자세한 계산은 `lib/sla-config.ts`, `lib/bigquery-sla.ts` 참고

### 미흡 상담사 기준에 생산성 추가?

- [ ] 추가 → 기준: [예: CPH ___건 미만이 2주 연속]
- [x] 추가하지 않음
- [ ] 미정

---

## 8. 우선순위

가장 먼저 만들어야 할 것에 1번, 그 다음 2번... 번호를 매겨주세요.

- [x] 1 기본 KPI 카드 (구현됨)
- [x] 2 일별/주별 추이 차트 (구현됨)
- [x] 3 서비스(버티컬)별 비교 (구현됨)
- [x] 4 센터별 비교 (구현됨)
- [x] 5 목표 대비 달성률 (구현됨)
- [ ] 6 상담사별 상세 테이블 (추후)
- [ ] 7 통합 품질 연계 (미정)

---

> 작성 완료 후 메이에게 전달해주세요.
> 모르는 항목은 비워두거나 "미정"으로 적어도 됩니다. 나중에 수정 가능합니다.
> 엑셀 원본 파일이 있으면 함께 공유해주시면 더 빠르게 진행됩니다.
